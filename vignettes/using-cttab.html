<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Alimu Dayimu" />

<meta name="date" content="2023-11-07" />

<title>Use cttab in the Analysis</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 800px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 20px;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 0;
padding: 4px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table:not([class]) {
margin: auto;
min-width: 40%;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table[summary="R argblock"] {
width: 100%;
border: none;
}
table:not([class]) th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table:not([class]) td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table:not([class]), table:not([class]) th, table:not([class]) td {
border-left-style: none;
border-right-style: none;
}
table:not([class]) tr.odd {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 13px;
padding-bottom: 1px;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f5f5f5;
border-radius: 3px;
color: #333;
}
pre {
overflow-x: auto;
border-radius: 3px;
margin: 5px 0 10px 0;
padding: 10px;
}
pre:not([class]) {
background-color: white;
border: #f5f5f5 1px solid;
}
pre:not([class]) code {
color: #444;
background-color: white;
}
code {
font-family: monospace;
font-size: 90%;
}
p > code, li > code {
padding: 2px 4px;
color: #d14;
border: 1px solid #e1e1e8;
white-space: inherit;
}
div.figure {
text-align: center;
}
table > caption, div.figure p.caption {
font-style: italic;
}
table > caption span, div.figure p.caption span {
font-style: normal;
font-weight: bold;
}
p {
margin: 0 0 10px;
}
table:not([class]) {
margin: auto auto 10px auto;
}
img:not([class]) {
background-color: #FFFFFF;
padding: 2px;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
max-width: 100%;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f5f5f5;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f5f5f5;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f5f5f5;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }
div.r-help-page {
background-color: #f9f9f9;
border-bottom: #ddd 1px solid;
margin-bottom: 10px;
padding: 10px;
}
div.r-help-page:hover {
background-color: #f4f4f4;
}

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Use cttab in the Analysis</h1>
<h4 class="author">Alimu Dayimu</h4>
<h4 class="date">2023-11-07</h4>


<div id="TOC">
<ul>
<li><a href="#what-this-document-does" id="toc-what-this-document-does">What this Document Does</a></li>
<li><a href="#whats-new" id="toc-whats-new">What’s new</a>
<ul>
<li><a href="#variable-and-value-label" id="toc-variable-and-value-label">Variable and value label</a></li>
<li><a href="#macro-dataset-utility-functions" id="toc-macro-dataset-utility-functions">MACRO dataset utility
functions</a></li>
<li><a href="#table-function" id="toc-table-function">Table
function</a></li>
<li><a href="#setting-options" id="toc-setting-options">Setting
options</a></li>
</ul></li>
<li><a href="#working-example" id="toc-working-example">Working
example</a>
<ul>
<li><a href="#data-reading" id="toc-data-reading">Data reading</a>
<ul>
<li><a href="#usual-case" id="toc-usual-case">Usual case</a></li>
<li><a href="#vertically-splited-multiple-data" id="toc-vertically-splited-multiple-data">Vertically splited multiple
data</a></li>
</ul></li>
<li><a href="#apply-macro-dictionary" id="toc-apply-macro-dictionary">Apply macro dictionary</a></li>
<li><a href="#data-analysis" id="toc-data-analysis">Data
analysis</a></li>
<li><a href="#formula-interface" id="toc-formula-interface">Formula
interface</a></li>
<li><a href="#missing-data-report" id="toc-missing-data-report">Missing
data report</a></li>
</ul></li>
<li><a href="#more-to-cttab" id="toc-more-to-cttab">More to cttab</a>
<ul>
<li><a href="#simple-table" id="toc-simple-table">Simple table</a></li>
<li><a href="#by-group-and-filter" id="toc-by-group-and-filter">By group
and filter</a></li>
<li><a href="#split-table-row-by-visit" id="toc-split-table-row-by-visit">Split table row by visit</a></li>
<li><a href="#group-variable" id="toc-group-variable">Group
variable</a></li>
<li><a href="#rounding" id="toc-rounding">Rounding</a></li>
</ul></li>
<li><a href="#cross-reference" id="toc-cross-reference">Cross
reference</a></li>
</ul>
</div>

<div id="what-this-document-does" class="section level1">
<h1>What this Document Does</h1>
<p>The package <code>cctu</code> has been updated to utilize the DLU
file and CLU file to facilitate the analyzing process. The newly added
functions will not affect previous process. But here, in this document
we are going to learn some new functions provided in the package to
facilitate your analysis. Before you start, you should get yourself
familiarized with the <code>cctu</code> package by looking through the
<code>Analysis Template</code> vignette. <strong>Remember, the
<code>sumby</code> function will not benefit from any of the data
attribute related new functions mentioned in this document</strong>.
Namely, the variable label and value labels will not have an effect on
the output. You don’t need to go through everything in this document if
you are going to stick to the <code>sumby</code> function.</p>
</div>
<div id="whats-new" class="section level1">
<h1>What’s new</h1>
<div id="variable-and-value-label" class="section level2">
<h2>Variable and value label</h2>
<p>If you are familiar with <code>SAS</code>, <code>Stata</code> or
<code>SPSS</code>, you should already know there’s a variable label and
value label (variable format in some). The variable label gives you the
description of the variable, and the value label is to explain what the
values stand for. The variable will stay as a numeric but has categories
attached to it. Which means, you can subset or manipulate it like a
numerical variable but report the data as a categorical one. It is
important to understand this, let’s use <code>mtcars</code> dataset and
demonstrate how it works.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># Assign variable label</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">var_lab</span>(mtcars<span class="sc">$</span>am) <span class="ot">&lt;-</span> <span class="st">&quot;Transmission&quot;</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># Assign value label with named vector</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">val_lab</span>(mtcars<span class="sc">$</span>am) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Automatic&quot;</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">&quot;Manual&quot;</span><span class="ot">=</span><span class="dv">1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">str</span>(mtcars<span class="sc">$</span>am)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt;  num [1:32] 1 1 1 0 0 0 0 0 0 0 ...</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;label&quot;)= chr &quot;Transmission&quot;</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;labels&quot;)= Named num [1:2] 0 1</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;Automatic&quot; &quot;Manual&quot;</span></span></code></pre></div>
<p>As you can above, <code>label</code> and <code>labels</code>
attributes were added. But the variable is numeric. You can still
summarize it as numeric variable as below:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">summary</span>(mtcars<span class="sc">$</span>am)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt;  0.0000  0.0000  0.0000  0.4062  1.0000  1.0000</span></span></code></pre></div>
<p>You can convert the value label to factor just before your final
analysis. The <code>to_factor</code> function replace the value with
labels and convert the variable to factor.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Extract variable label</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">var_lab</span>(mtcars<span class="sc">$</span>am)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Transmission&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># Convert variable to factor with labels attached to it</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">to_factor</span>(mtcars<span class="sc">$</span>am))</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; Automatic    Manual </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;        19        13</span></span></code></pre></div>
<p>But be cautious, <strong>some R process might drop the variable or
value label attributes</strong>. Normally it won’t, but you should check
it before report if you are not sure. For example,
<code>as.numeric</code>, <code>as.character</code> and
<code>as.logiac</code> will drop the variable and value label. There are
<code>to_numeric</code>, <code>to_character</code> and
<code>to_logical</code> can be used to convert the data type. You can
also use the <code>copy_lab</code> function to copy the variable and
value labels from the other variable.</p>
<p>You can use <code>var_lab</code> to extract the variable label or
assign one. And use <code>has.label</code> to check if the variable has
any variable label with it. You may also want to use
<code>drop_lab</code> to drop the variable label.</p>
<p>For value label, you can use <code>val_lab</code> to extract or
assign value label. And use <code>has.labels</code> to check if the
variable has a value label. There are also <code>unval</code> function
to drop the value label and <code>lab2val</code> to replace the
<code>data.frame</code> value to its corresponding value labels.</p>
</div>
<div id="macro-dataset-utility-functions" class="section level2">
<h2>MACRO dataset utility functions</h2>
<p>There are new functions have been added to utilize the DLU and CLU
files for the data analysis. The <code>apply_macro_dict</code> function
uses DLU and CLU file to assign variable and value labels to the
dataset. This function will convert the variable name in the data and
DLU to lower case by default. This will also convert the dataset based
on the variable type as in the DLU file. If you don’t want to convert
the variable name to lower cases, you should set
<code>clean_names = FALSE</code>.</p>
<p>The <code>extract_form</code> can extract MACRO data by form and
visits. The data will be converted to <code>data.table</code> class,
which is an extension of the <code>data.frame</code> and works exactly
the same. It is a great package with lots of data manipulation
capability, you should seek the <a href="https://CRAN.R-project.org/package=data.table">website</a> for
more details. But one thing to remember is that all the names in the
variable selection will be considered as a variable of the data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mpg&quot;</span>, <span class="st">&quot;am&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># You can do this in the normal data.frame</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>mtcars[,vars]</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co"># But you can&#39;t do this for the data.table</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>dat <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(mtcars)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>mtcars[,vars]</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co"># You need to add with=FALSE to do that</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>mtcars[,vars, with<span class="ot">=</span><span class="cn">FALSE</span>]</span></code></pre></div>
</div>
<div id="table-function" class="section level2">
<h2>Table function</h2>
<p>You might already knew how to use the <code>sumby</code> function,
but now a new function called <code>cttab</code> has been added. The
difference between these two functions are the latter can handle
variable label and value labels. You can feed the labelled data to this
function and it will populate a summary table. Report data by treatment
group, stratify tables by visit. Also, you can report variable based on
some conditions and group the variable in the report. It generates a
missing report internally and you can dump the missing report at the
end. No extra step is needed. It will also produce the summary plots of
the variables. The produced plots will be arrange to 3 by 3 and new plot
will be producd if the variables exceeds 9. The remaining of this
document will show you with a working case.</p>
</div>
<div id="setting-options" class="section level2">
<h2>Setting options</h2>
<p>The <code>cctab</code> function has a good flexibility, which means
it has lots of parameters you can use. You should check out the manual
of the <code>cctab</code> function. But, you can use
<code>options</code> to set the default value of the parameters to be
used by <code>cctab</code>. Below is setting some of the options, for
more details please check out the <code>cctab</code> function
manuals.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">cctu_digits =</span> <span class="dv">3</span>) <span class="co"># keep 3 digits for numerical value</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">options</span>(<span class="at">cctu_digits_pct =</span> <span class="dv">0</span>) <span class="co"># keep 0 digits for percentage </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">options</span>(<span class="at">cctu_subjid_string =</span> <span class="st">&quot;subjid&quot;</span>) <span class="co"># Set subject ID string</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">cctu_print_plot =</span> <span class="cn">FALSE</span>) <span class="co"># Don&#39;t produce plots</span></span></code></pre></div>
</div>
</div>
<div id="working-example" class="section level1">
<h1>Working example</h1>
<p>In this section, we will show how to populate tables.</p>
<div id="data-reading" class="section level2">
<h2>Data reading</h2>
<div id="usual-case" class="section level3">
<h3>Usual case</h3>
<p>You should read the data as before, but you can and should read the
data by setting all the columns to character. This will be handled
later. Same process can be found in the <code>Analysis Template</code>
vignette.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Read example data</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;pilotdata.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;cctu&quot;</span>), <span class="at">colClasses =</span> <span class="st">&quot;character&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># Read DLU and CLU</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>dlu <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;pilotdata_dlu.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;cctu&quot;</span>))</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>clu <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;pilotdata_clu.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;cctu&quot;</span>))</span></code></pre></div>
</div>
<div id="vertically-splited-multiple-data" class="section level3">
<h3>Vertically splited multiple data</h3>
<p>If you have multiple datasets, you should combine them at this stage.
If multiple datasets are given and they have the same variable name, you
can use <code>rbind</code> function to combine data together. If you
have different datasets with different variable names except for some
key variables, you can use <code>merge_data</code> function to combine
them together.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Read example data</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>dt_a <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_A.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;cctu&quot;</span>),</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                 <span class="at">colClasses =</span> <span class="st">&quot;character&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>dt_b <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_B.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;cctu&quot;</span>),</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                 <span class="at">colClasses =</span> <span class="st">&quot;character&quot;</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co"># Read DLU and CLU</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>dlu_a <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_A_DLU.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;cctu&quot;</span>))</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>dlu_b <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_B_DLU.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;cctu&quot;</span>))</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>clu_a <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_A_CLU.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;cctu&quot;</span>))</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>clu_b <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_B_CLU.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;cctu&quot;</span>))</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co"># Merge dataset with merge_data function</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">merge_data</span>(<span class="at">datalist =</span> <span class="fu">list</span>(dt_a, dt_b), <span class="at">dlulist =</span> <span class="fu">list</span>(dlu_a, dlu_b),</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>                  <span class="at">clulist =</span> <span class="fu">list</span>(clu_a, clu_b))</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>dt <span class="ot">&lt;-</span> res<span class="sc">$</span>data <span class="co"># Extract combined data</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>dlu <span class="ot">&lt;-</span> res<span class="sc">$</span>dlu <span class="co"># Extract combined DLU data</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>clu <span class="ot">&lt;-</span> res<span class="sc">$</span>clu <span class="co"># Extract combined CLU data</span></span></code></pre></div>
</div>
</div>
<div id="apply-macro-dictionary" class="section level2">
<h2>Apply macro dictionary</h2>
<p>Next, we will apply the DLU and CLU files to the dataset. <strong>Do
not clean variable name</strong> in the dataset and DLU/CLU files before
applying <code>apply_macro_dict</code>. The function can handle variable
name cleaning by setting <code>clean_names = TRUE</code>, this is
default behaviour. The <code>apply_macro_dict</code> function will clean
the variable name in the DLU and CLU, then apply these macro meta data
to the target dataset. The cleaned DLU data will be sotred internally
and is further used by <code>cttab</code> to report missingness. You can
use <code>get_dlu</code> to extract the internal DLU data after applying
<code>apply_macro_dict</code> to the dataset for further useage or as a
reference. Although you can use <code>set_dlu</code> to change the
internal DLU data stored by <code>apply_macro_dict</code>, this is not
recommended unless you know what you are doing. This will have an impact
on the missing report.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Create subjid</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>dt<span class="sc">$</span>subjid <span class="ot">&lt;-</span> <span class="fu">substr</span>(dt<span class="sc">$</span>USUBJID, <span class="dv">8</span>, <span class="dv">11</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># Apply CLU and DLU files</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">apply_macro_dict</span>(dt, <span class="at">dlu =</span> dlu, <span class="at">clu =</span> clu, <span class="at">clean_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co"># Give new variable a label</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="fu">var_lab</span>(dt<span class="sc">$</span>subjid) <span class="ot">&lt;-</span> <span class="st">&quot;Subject ID&quot;</span></span></code></pre></div>
<p>After this, you should follow the <code>Analysis Template</code>
vignette and setup the population etc.</p>
<pre><code>#&gt; safety environment created in R_GlobalEnv 
#&gt; data frames removed from R_GlobalEnv : dt</code></pre>
<p>Next we will do some data analysis.</p>
</div>
<div id="data-analysis" class="section level2">
<h2>Data analysis</h2>
<p>After you have attached the population, next thing you may want to do
is extract a particular form from the data. For the table, assume we are
reporting age, sex and BMI from the patient registration form by
treatment arm. For demonstrating the filtering, we only report non-white
patients’ BMI.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Attach population</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">attach_pop</span>(<span class="st">&quot;1.1&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; safety attached containing: dt</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co"># Extract patient patient registration form and keep subjid variable</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">extract_form</span>(dt, <span class="st">&quot;PatientReg&quot;</span>, <span class="at">vars_keep =</span> <span class="fu">c</span>(<span class="st">&quot;subjid&quot;</span>))</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co"># Now report Age, Sex and BMI. For BMI, report not white only </span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cttab</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;AGE&quot;</span>, <span class="st">&quot;SEX&quot;</span>, <span class="st">&quot;BMIBL&quot;</span>), <span class="co"># Variable to report</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>           <span class="at">group =</span> <span class="st">&quot;ARM&quot;</span>,                  <span class="co"># Group variable</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>           <span class="at">data =</span> df,                      <span class="co"># Data</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>           <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;BMIBL&quot;</span> <span class="ot">=</span> <span class="st">&quot;RACEN != 1&quot;</span>)) <span class="co"># Filter for variable BMI</span></span></code></pre></div>
<p><img src="data:text/html; charset=iso-8859-1;charset=utf-8,%3C%21DOCTYPE%20HTML%20PUBLIC%20%22%2D%2F%2FIETF%2F%2FDTD%20HTML%202%2E0%2F%2FEN%22%3E%0A%3Chtml%3E%3Chead%3E%0A%3Ctitle%3E404%20Not%20Found%3C%2Ftitle%3E%0A%3C%2Fhead%3E%3Cbody%3E%0A%3Ch1%3ENot%20Found%3C%2Fh1%3E%0A%3Cp%3EThe%20requested%20URL%20was%20not%20found%20on%20this%20server%2E%3C%2Fp%3E%0A%3C%2Fbody%3E%3C%2Fhtml%3E%0A" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co"># Write table</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>X</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; ┌───────────────────┬─────────────────┬─────────────────┬─────────────────┐</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; |                   │     Placebo     │    Research     │      Total      |</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; |Observation        │       48        │       52        │       100       |</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; |Age                                                                      |</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       48        │       52        │       100       |</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   75.5 (7.86)   │   74.8 (8.04)   │   75.1 (7.93)   |</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│78.0 [57.0, 88.0]│77.0 [56.0, 88.0]│77.0 [56.0, 88.0]|</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; |Sex                                                                      |</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; |  Female           │   26/48 (54%)   │   25/52 (48%)   │  51/100 (51%)   |</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; |  Male             │   22/48 (46%)   │   27/52 (52%)   │  49/100 (49%)   |</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; |Baseline BMI (kg/m^2)                                                    |</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │        5        │        6        │       11        |</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   27.8 (3.98)   │   24.6 (3.54)   │   26.0 (3.93)   |</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│27.9 [23.4, 32.8]│23.5 [21.3, 31.4]│24.3 [21.3, 32.8]|</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; └───────────────────┴─────────────────┴─────────────────┴─────────────────┘</span></span></code></pre></div>
</div>
<div id="formula-interface" class="section level2">
<h2>Formula interface</h2>
<p>One can use formula in the <code>cctab</code> just like
<code>lm</code>, but you will not be able to group variables (described
in the later section). The left hand side of the formula is the
variables to be summarised. Right hand side of the formula is the
grouping and/or row splitting variables. The by visit variable should be
separated by <code>|</code> with grouping variable, use <code>1</code>
if there is no grouping variables. No <code>group</code> or
<code>row_split</code> parameters to be used in the formula interface.
All the other parameters are the same.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># No grouping</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cttab</span>(AGE <span class="sc">+</span> SEX <span class="sc">+</span> BMIBL  <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># Group summarise by ARM</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cttab</span>(AGE <span class="sc">+</span> SEX <span class="sc">+</span> BMIBL <span class="sc">~</span> ARM, <span class="at">data =</span> df)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># Group summarise by ARM and split by visit cycle</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cttab</span>(AST <span class="sc">+</span> BILI <span class="sc">~</span> ARM <span class="sc">|</span> AVISIT, <span class="at">data =</span> df)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co"># Split by visit cycle</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cttab</span>(AST <span class="sc">+</span> BILI <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> AVISIT, <span class="at">data =</span> df)</span></code></pre></div>
</div>
<div id="missing-data-report" class="section level2">
<h2>Missing data report</h2>
<p>The <code>cttab</code> function will report the missing internally.
You can use the following to get the missing report.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># This will save the missing report under Output folder</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co"># Or you can set the output folder and name</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">dump_missing_report</span>()</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># Pull out the missing report if you want </span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>miss_rep <span class="ot">&lt;-</span> <span class="fu">get_missing_report</span>()</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co"># Reset missing report</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="fu">reset_missing_report</span>()</span></code></pre></div>
<p>After this, you can finish the remaining as in the
<code>Analysis Template</code> vignette.</p>
</div>
</div>
<div id="more-to-cttab" class="section level1">
<h1>More to cttab</h1>
<p>As you have seen previously, the <code>cttab</code> function can
easily populate simple tables.</p>
<div id="simple-table" class="section level2">
<h2>Simple table</h2>
<p>Table only some variables, no treatment arm or variable
selection.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cttab</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;AGE&quot;</span>, <span class="st">&quot;SEX&quot;</span>, <span class="st">&quot;BMIBL&quot;</span>), <span class="co"># Variable to report</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>           <span class="at">data =</span> df)                      <span class="co"># Data</span></span></code></pre></div>
<p><img src="data:text/html; charset=iso-8859-1;charset=utf-8,%3C%21DOCTYPE%20HTML%20PUBLIC%20%22%2D%2F%2FIETF%2F%2FDTD%20HTML%202%2E0%2F%2FEN%22%3E%0A%3Chtml%3E%3Chead%3E%0A%3Ctitle%3E404%20Not%20Found%3C%2Ftitle%3E%0A%3C%2Fhead%3E%3Cbody%3E%0A%3Ch1%3ENot%20Found%3C%2Fh1%3E%0A%3Cp%3EThe%20requested%20URL%20was%20not%20found%20on%20this%20server%2E%3C%2Fp%3E%0A%3C%2Fbody%3E%3C%2Fhtml%3E%0A" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>X</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; ┌───────────────────┬─────────────────┐</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; |                   │      Total      |</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┤</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; |Age                                  |</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┤</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       100       |</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   75.1 (7.93)   |</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│77.0 [56.0, 88.0]|</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┤</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; |Sex                                  |</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┤</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; |  Female           │  51/100 (51%)   |</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; |  Male             │  49/100 (49%)   |</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┤</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; |Baseline BMI (kg/m^2)                |</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┤</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       100       |</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   24.5 (4.15)   |</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│24.4 [13.7, 33.6]|</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; └───────────────────┴─────────────────┘</span></span></code></pre></div>
</div>
<div id="by-group-and-filter" class="section level2">
<h2>By group and filter</h2>
<p>This is what we have seen before</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cttab</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;AGE&quot;</span>, <span class="st">&quot;SEX&quot;</span>, <span class="st">&quot;BMIBL&quot;</span>), <span class="co"># Variable to report</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>           <span class="at">group =</span> <span class="st">&quot;ARM&quot;</span>,                  <span class="co"># Group variable</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>           <span class="at">data =</span> df,                      <span class="co"># Data</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>           <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;BMIBL&quot;</span> <span class="ot">=</span> <span class="st">&quot;RACEN != 1&quot;</span>)) <span class="co"># Filter for variable BMI</span></span></code></pre></div>
<p><img src="data:text/html; charset=iso-8859-1;charset=utf-8,%3C%21DOCTYPE%20HTML%20PUBLIC%20%22%2D%2F%2FIETF%2F%2FDTD%20HTML%202%2E0%2F%2FEN%22%3E%0A%3Chtml%3E%3Chead%3E%0A%3Ctitle%3E404%20Not%20Found%3C%2Ftitle%3E%0A%3C%2Fhead%3E%3Cbody%3E%0A%3Ch1%3ENot%20Found%3C%2Fh1%3E%0A%3Cp%3EThe%20requested%20URL%20was%20not%20found%20on%20this%20server%2E%3C%2Fp%3E%0A%3C%2Fbody%3E%3C%2Fhtml%3E%0A" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>X</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt; ┌───────────────────┬─────────────────┬─────────────────┬─────────────────┐</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; |                   │     Placebo     │    Research     │      Total      |</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; |Observation        │       48        │       52        │       100       |</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt; |Age                                                                      |</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       48        │       52        │       100       |</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   75.5 (7.86)   │   74.8 (8.04)   │   75.1 (7.93)   |</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│78.0 [57.0, 88.0]│77.0 [56.0, 88.0]│77.0 [56.0, 88.0]|</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; |Sex                                                                      |</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; |  Female           │   26/48 (54%)   │   25/52 (48%)   │  51/100 (51%)   |</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt; |  Male             │   22/48 (46%)   │   27/52 (52%)   │  49/100 (49%)   |</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; |Baseline BMI (kg/m^2)                                                    |</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │        5        │        6        │       11        |</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   27.8 (3.98)   │   24.6 (3.54)   │   26.0 (3.93)   |</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│27.9 [23.4, 32.8]│23.5 [21.3, 31.4]│24.3 [21.3, 32.8]|</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt; └───────────────────┴─────────────────┴─────────────────┴─────────────────┘</span></span></code></pre></div>
</div>
<div id="split-table-row-by-visit" class="section level2">
<h2>Split table row by visit</h2>
<p>You can define <code>row_split</code> parameter to the name of visit
or repeat variable.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">attach_pop</span>(<span class="st">&quot;1.1&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt; safety detached.</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; safety attached containing: dt</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">extract_form</span>(dt, <span class="st">&quot;Lab&quot;</span>, <span class="at">vars_keep =</span> <span class="fu">c</span>(<span class="st">&quot;subjid&quot;</span>, <span class="st">&quot;ARM&quot;</span>))</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cttab</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;AST&quot;</span>, <span class="st">&quot;BILI&quot;</span>, <span class="st">&quot;ALT&quot;</span>),</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>           <span class="at">group =</span> <span class="st">&quot;ARM&quot;</span>,</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>           <span class="at">data =</span> df,</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>           <span class="at">row_split =</span> <span class="st">&quot;AVISIT&quot;</span>,            <span class="co"># Visit variable</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>           <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;ALT&quot;</span> <span class="ot">=</span> <span class="st">&quot;PERF == 1&quot;</span>))</span></code></pre></div>
<p><img src="data:text/html; charset=iso-8859-1;charset=utf-8,%3C%21DOCTYPE%20HTML%20PUBLIC%20%22%2D%2F%2FIETF%2F%2FDTD%20HTML%202%2E0%2F%2FEN%22%3E%0A%3Chtml%3E%3Chead%3E%0A%3Ctitle%3E404%20Not%20Found%3C%2Ftitle%3E%0A%3C%2Fhead%3E%3Cbody%3E%0A%3Ch1%3ENot%20Found%3C%2Fh1%3E%0A%3Cp%3EThe%20requested%20URL%20was%20not%20found%20on%20this%20server%2E%3C%2Fp%3E%0A%3C%2Fbody%3E%3C%2Fhtml%3E%0A" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>X</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co">#&gt; ┌───────────────────┬─────────────────┬─────────────────┬─────────────────┐</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt; |                   │     Placebo     │    Research     │      Total      |</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt; |Study Visit = Baseline                                                   |</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt; |Observation        │       48        │       52        │       100       |</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt; |Aspartate Aminotransferase (U/L)                                         |</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       47        │       52        │       99        |</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   23.4 (7.09)   │   23.6 (7.05)   │   23.5 (7.04)   |</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│23.0 [12.0, 54.0]│21.5 [13.0, 52.0]│23.0 [12.0, 54.0]|</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt; |  Missing          │     1 (2%)      │                 │     1 (1%)      |</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; |Bilirubin (umol/L)                                                       |</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       46        │       51        │       97        |</span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   10.0 (4.38)   │   11.4 (6.01)   │   10.8 (5.32)   |</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│8.55 [5.13, 25.7]│10.3 [5.13, 39.3]│10.3 [5.13, 39.3]|</span></span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a><span class="co">#&gt; |  Missing          │     2 (4%)      │     1 (2%)      │     3 (3%)      |</span></span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a><span class="co">#&gt; |Alanine Aminotransferase (U/L)                                           |</span></span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       45        │       40        │       85        |</span></span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   18.1 (8.01)   │   22.1 (13.2)   │   20.0 (10.9)   |</span></span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│16.0 [7.00, 50.0]│17.0 [8.00, 64.0]│16.0 [7.00, 64.0]|</span></span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a><span class="co">#&gt; |  Missing          │                 │     2 (5%)      │     2 (2%)      |</span></span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a><span class="co">#&gt; |Study Visit = Week 4                                                     |</span></span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a><span class="co">#&gt; |Observation        │       43        │       44        │       87        |</span></span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a><span class="co">#&gt; |Aspartate Aminotransferase (U/L)                                         |</span></span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       41        │       43        │       84        |</span></span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   25.1 (18.4)   │   23.8 (6.39)   │   24.4 (13.6)   |</span></span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│23.0 [12.0, 135] │23.0 [12.0, 43.0]│23.0 [12.0, 135] |</span></span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a><span class="co">#&gt; |  Missing          │     2 (5%)      │     1 (2%)      │     3 (3%)      |</span></span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a><span class="co">#&gt; |Bilirubin (umol/L)                                                       |</span></span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       42        │       44        │       86        |</span></span>
<span id="cb19-45"><a href="#cb19-45" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   12.7 (18.2)   │   11.4 (6.51)   │   12.0 (13.5)   |</span></span>
<span id="cb19-46"><a href="#cb19-46" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│8.55 [5.13, 125] │8.55 [5.13, 34.2]│8.55 [5.13, 125] |</span></span>
<span id="cb19-47"><a href="#cb19-47" tabindex="-1"></a><span class="co">#&gt; |  Missing          │     1 (2%)      │                 │     1 (1%)      |</span></span>
<span id="cb19-48"><a href="#cb19-48" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb19-49"><a href="#cb19-49" tabindex="-1"></a><span class="co">#&gt; |Alanine Aminotransferase (U/L)                                           |</span></span>
<span id="cb19-50"><a href="#cb19-50" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb19-51"><a href="#cb19-51" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       39        │       38        │       77        |</span></span>
<span id="cb19-52"><a href="#cb19-52" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   18.9 (16.1)   │   21.6 (11.0)   │   20.2 (13.8)   |</span></span>
<span id="cb19-53"><a href="#cb19-53" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│15.0 [7.00, 107] │20.0 [8.00, 61.0]│16.0 [7.00, 107] |</span></span>
<span id="cb19-54"><a href="#cb19-54" tabindex="-1"></a><span class="co">#&gt; |  Missing          │                 │     3 (7%)      │     3 (4%)      |</span></span>
<span id="cb19-55"><a href="#cb19-55" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb19-56"><a href="#cb19-56" tabindex="-1"></a><span class="co">#&gt; |Study Visit = End of Treatment                                           |</span></span>
<span id="cb19-57"><a href="#cb19-57" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb19-58"><a href="#cb19-58" tabindex="-1"></a><span class="co">#&gt; |Observation        │       47        │       50        │       97        |</span></span>
<span id="cb19-59"><a href="#cb19-59" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb19-60"><a href="#cb19-60" tabindex="-1"></a><span class="co">#&gt; |Aspartate Aminotransferase (U/L)                                         |</span></span>
<span id="cb19-61"><a href="#cb19-61" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb19-62"><a href="#cb19-62" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       45        │       48        │       93        |</span></span>
<span id="cb19-63"><a href="#cb19-63" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   27.4 (27.9)   │   23.1 (6.04)   │   25.2 (19.9)   |</span></span>
<span id="cb19-64"><a href="#cb19-64" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│21.0 [14.0, 168] │23.0 [12.0, 39.0]│22.0 [12.0, 168] |</span></span>
<span id="cb19-65"><a href="#cb19-65" tabindex="-1"></a><span class="co">#&gt; |  Missing          │     2 (4%)      │     2 (4%)      │     4 (4%)      |</span></span>
<span id="cb19-66"><a href="#cb19-66" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb19-67"><a href="#cb19-67" tabindex="-1"></a><span class="co">#&gt; |Bilirubin (umol/L)                                                       |</span></span>
<span id="cb19-68"><a href="#cb19-68" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb19-69"><a href="#cb19-69" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       45        │       46        │       91        |</span></span>
<span id="cb19-70"><a href="#cb19-70" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   12.5 (17.7)   │   11.5 (6.39)   │   12.0 (13.2)   |</span></span>
<span id="cb19-71"><a href="#cb19-71" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│8.55 [5.13, 125] │10.3 [3.42, 30.8]│8.55 [3.42, 125] |</span></span>
<span id="cb19-72"><a href="#cb19-72" tabindex="-1"></a><span class="co">#&gt; |  Missing          │     2 (4%)      │     4 (8%)      │     6 (6%)      |</span></span>
<span id="cb19-73"><a href="#cb19-73" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb19-74"><a href="#cb19-74" tabindex="-1"></a><span class="co">#&gt; |Alanine Aminotransferase (U/L)                                           |</span></span>
<span id="cb19-75"><a href="#cb19-75" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb19-76"><a href="#cb19-76" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       45        │       43        │       88        |</span></span>
<span id="cb19-77"><a href="#cb19-77" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   19.6 (21.8)   │   19.7 (8.41)   │   19.6 (16.6)   |</span></span>
<span id="cb19-78"><a href="#cb19-78" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│14.0 [5.00, 124] │17.0 [9.00, 43.0]│16.0 [5.00, 124] |</span></span>
<span id="cb19-79"><a href="#cb19-79" tabindex="-1"></a><span class="co">#&gt; |  Missing          │                 │     1 (2%)      │     1 (1%)      |</span></span>
<span id="cb19-80"><a href="#cb19-80" tabindex="-1"></a><span class="co">#&gt; └───────────────────┴─────────────────┴─────────────────┴─────────────────┘</span></span></code></pre></div>
</div>
<div id="group-variable" class="section level2">
<h2>Group variable</h2>
<p>In this example, we will report demographic variable, lab results and
lab abnormality. Variables will be grouped, no group name will be given
to demographic variables, “Blood” to lab results and “Pts with Abnormal”
to lab abnormality. Here, we count the number of patients with abnormal
lab results. The <code>cttab</code> will report the count and percentage
of <code>TRUE</code>. This is useful if you want to report patient
numbers for different condition that belong to one category. Below is
how to do it:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Prepare data as before</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">attach_pop</span>(<span class="st">&quot;1.1&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt; safety detached.</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#&gt; safety attached containing: dt</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">extract_form</span>(dt, <span class="st">&quot;PatientReg&quot;</span>, <span class="at">vars_keep =</span> <span class="fu">c</span>(<span class="st">&quot;subjid&quot;</span>))</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>base_lab <span class="ot">&lt;-</span> <span class="fu">extract_form</span>(dt, <span class="st">&quot;Lab&quot;</span>, <span class="at">visit =</span> <span class="st">&quot;SCREENING&quot;</span>,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>                         <span class="at">vars_keep =</span> <span class="fu">c</span>(<span class="st">&quot;subjid&quot;</span>))</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co"># Define abnormal</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>base_lab<span class="sc">$</span>ABNORMALT <span class="ot">&lt;-</span> base_lab<span class="sc">$</span>ALT <span class="sc">&gt;</span> <span class="fl">22.5</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="fu">var_lab</span>(base_lab<span class="sc">$</span>ABNORMALT) <span class="ot">&lt;-</span> <span class="st">&quot;ALT abnormal&quot;</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>base_lab<span class="sc">$</span>ABNORMAST <span class="ot">&lt;-</span> base_lab<span class="sc">$</span>AST <span class="sc">&gt;</span> <span class="fl">25.5</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="fu">var_lab</span>(base_lab<span class="sc">$</span>ABNORMAST) <span class="ot">&lt;-</span> <span class="st">&quot;AST abnormal&quot;</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">merge</span>(df, base_lab, <span class="at">by =</span> <span class="st">&quot;subjid&quot;</span>)</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="co"># Table</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cttab</span>(<span class="at">x =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;AGE&quot;</span>, <span class="st">&quot;SEX&quot;</span>, <span class="st">&quot;BMIBL&quot;</span>),</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>                       <span class="co"># Group lab variable</span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>                       <span class="st">&quot;Blood&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;ALT&quot;</span>, <span class="st">&quot;AST&quot;</span>),</span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>                       <span class="co"># Group abnormal variable</span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>                       <span class="st">&quot;Pts with Abnormal&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;ABNORMAST&quot;</span>, <span class="st">&quot;ABNORMALT&quot;</span>)),</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>           <span class="at">group =</span> <span class="st">&quot;ARM&quot;</span>,</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>           <span class="at">data =</span> df,</span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>           <span class="co"># Add some filtering</span></span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>           <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;BMIBL&quot;</span> <span class="ot">=</span> <span class="st">&quot;RACEN != 1&quot;</span>,</span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a>                      <span class="st">&quot;ALT&quot;</span> <span class="ot">=</span> <span class="st">&quot;PERF == 1&quot;</span>))</span></code></pre></div>
<p><img src="data:text/html; charset=iso-8859-1;charset=utf-8,%3C%21DOCTYPE%20HTML%20PUBLIC%20%22%2D%2F%2FIETF%2F%2FDTD%20HTML%202%2E0%2F%2FEN%22%3E%0A%3Chtml%3E%3Chead%3E%0A%3Ctitle%3E404%20Not%20Found%3C%2Ftitle%3E%0A%3C%2Fhead%3E%3Cbody%3E%0A%3Ch1%3ENot%20Found%3C%2Fh1%3E%0A%3Cp%3EThe%20requested%20URL%20was%20not%20found%20on%20this%20server%2E%3C%2Fp%3E%0A%3C%2Fbody%3E%3C%2Fhtml%3E%0A" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>X                     </span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">#&gt; ┌───────────────────┬─────────────────┬─────────────────┬─────────────────┐</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt; |                   │     Placebo     │    Research     │      Total      |</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt; |Observation        │       48        │       52        │       100       |</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; |Age                                                                      |</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       48        │       52        │       100       |</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   75.5 (7.86)   │   74.8 (8.04)   │   75.1 (7.93)   |</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│78.0 [57.0, 88.0]│77.0 [56.0, 88.0]│77.0 [56.0, 88.0]|</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co">#&gt; |Sex                                                                      |</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co">#&gt; |  Female           │   26/48 (54%)   │   25/52 (48%)   │  51/100 (51%)   |</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">#&gt; |  Male             │   22/48 (46%)   │   27/52 (52%)   │  49/100 (49%)   |</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#&gt; |Baseline BMI (kg/m^2)                                                    |</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │        5        │        6        │       11        |</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   27.8 (3.98)   │   24.6 (3.54)   │   26.0 (3.93)   |</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│27.9 [23.4, 32.8]│23.5 [21.3, 31.4]│24.3 [21.3, 32.8]|</span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="co">#&gt; |Blood                                                                    |</span></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a><span class="co">#&gt; |Alanine Aminotransferase (U/L)                                           |</span></span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       45        │       40        │       85        |</span></span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   18.1 (8.01)   │   22.1 (13.2)   │   20.0 (10.9)   |</span></span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│16.0 [7.00, 50.0]│17.0 [8.00, 64.0]│16.0 [7.00, 64.0]|</span></span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a><span class="co">#&gt; |  Missing          │                 │     2 (5%)      │     2 (2%)      |</span></span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a><span class="co">#&gt; |Aspartate Aminotransferase (U/L)                                         |</span></span>
<span id="cb21-37"><a href="#cb21-37" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb21-38"><a href="#cb21-38" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       47        │       52        │       99        |</span></span>
<span id="cb21-39"><a href="#cb21-39" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │   23.4 (7.09)   │   23.6 (7.05)   │   23.5 (7.04)   |</span></span>
<span id="cb21-40"><a href="#cb21-40" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│23.0 [12.0, 54.0]│21.5 [13.0, 52.0]│23.0 [12.0, 54.0]|</span></span>
<span id="cb21-41"><a href="#cb21-41" tabindex="-1"></a><span class="co">#&gt; |  Missing          │     1 (2%)      │                 │     1 (1%)      |</span></span>
<span id="cb21-42"><a href="#cb21-42" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span id="cb21-43"><a href="#cb21-43" tabindex="-1"></a><span class="co">#&gt; |Pts with Abnormal                                                        |</span></span>
<span id="cb21-44"><a href="#cb21-44" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span id="cb21-45"><a href="#cb21-45" tabindex="-1"></a><span class="co">#&gt; |AST abnormal       │   13/48 (27%)   │   17/52 (33%)   │  30/100 (30%)   |</span></span>
<span id="cb21-46"><a href="#cb21-46" tabindex="-1"></a><span class="co">#&gt; |ALT abnormal       │   9/48 (19%)    │   11/52 (21%)   │  20/100 (20%)   |</span></span>
<span id="cb21-47"><a href="#cb21-47" tabindex="-1"></a><span class="co">#&gt; └───────────────────┴─────────────────┴─────────────────┴─────────────────┘</span></span></code></pre></div>
</div>
<div id="rounding" class="section level2">
<h2>Rounding</h2>
<p>The default behaviour of this function is to keep one digits for the
percentage and 3 significant value for the numerical values. The default
rounding function is <code>signif_pad</code>, you can also use
<code>round</code> or <code>round_pad</code> to keep digits in the
summary. The <code>format_percent</code> function is used to format the
percentage values. There is <code>format_pval</code> might be useful to
you.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cttab</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;AGE&quot;</span>, <span class="st">&quot;SEX&quot;</span>, <span class="st">&quot;BMIBL&quot;</span>), <span class="co"># Variable to report</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>           <span class="at">group =</span> <span class="st">&quot;ARM&quot;</span>,                  <span class="co"># Group variable</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>           <span class="at">data =</span> df,                      <span class="co"># Data</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>           <span class="at">digits =</span> <span class="dv">2</span>,                     <span class="co"># Keep 2 digits for numerical </span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>           <span class="at">digits_pct =</span> <span class="dv">1</span>,                 <span class="co"># Keep 1 digits for percentage</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>           <span class="at">rounding_fn =</span> round)            <span class="co"># Use function round for rounding</span></span></code></pre></div>
<p><img src="data:text/html; charset=iso-8859-1;charset=utf-8,%3C%21DOCTYPE%20HTML%20PUBLIC%20%22%2D%2F%2FIETF%2F%2FDTD%20HTML%202%2E0%2F%2FEN%22%3E%0A%3Chtml%3E%3Chead%3E%0A%3Ctitle%3E404%20Not%20Found%3C%2Ftitle%3E%0A%3C%2Fhead%3E%3Cbody%3E%0A%3Ch1%3ENot%20Found%3C%2Fh1%3E%0A%3Cp%3EThe%20requested%20URL%20was%20not%20found%20on%20this%20server%2E%3C%2Fp%3E%0A%3C%2Fbody%3E%3C%2Fhtml%3E%0A" width="672" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>X</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">#&gt; ┌───────────────────┬─────────────────┬──────────────────┬──────────────────┐</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#&gt; |                   │     Placebo     │     Research     │      Total       |</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴──────────────────┴──────────────────┤</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt; |Observation        │       48        │        52        │       100        |</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬──────────────────┬──────────────────┤</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴──────────────────┴──────────────────┤</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; |Age                                                                        |</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬──────────────────┬──────────────────┤</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       48        │        52        │       100        |</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │  75.52 (7.86)   │   74.75 (8.04)   │   75.12 (7.93)   |</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│   78 [57, 88]   │   77 [56, 88]    │   77 [56, 88]    |</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴──────────────────┴──────────────────┤</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co">#&gt; |Sex                                                                        |</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬──────────────────┬──────────────────┤</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt; |  Female           │  26/48 (54.2%)  │  25/52 (48.1%)   │  51/100 (51.0%)  |</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co">#&gt; |  Male             │  22/48 (45.8%)  │  27/52 (51.9%)   │  49/100 (49.0%)  |</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┴─────────────────┴──────────────────┴──────────────────┤</span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co">#&gt; |Baseline BMI (kg/m^2)                                                      |</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co">#&gt; ├───────────────────┬─────────────────┬──────────────────┬──────────────────┤</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co">#&gt; |  Valid Obs.       │       48        │        52        │       100        |</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="co">#&gt; |  Mean (SD)        │  23.55 (4.05)   │   25.29 (4.1)    │   24.45 (4.15)   |</span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co">#&gt; |  Median [Min, Max]│23.1 [15.1, 33.3]│25.25 [13.7, 33.6]│24.35 [13.7, 33.6]|</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="co">#&gt; └───────────────────┴─────────────────┴──────────────────┴──────────────────┘</span></span></code></pre></div>
</div>
</div>
<div id="cross-reference" class="section level1">
<h1>Cross reference</h1>
<p>Tables can be cross-referenced in the word. This is very convenient
if you are writing narratives and want to reference tables or figures.
You can find how to cross reference tables or figures <a href="https://erinwrightwriting.com/cross-reference-tables-and-figures-in-microsoft-word/">here</a>.
If you can changed the order of the tables by cut and paste or by
dragging the headings in the navigation pane of the word the reference
will still be there. You can press <code>Ctrl+A</code> select all, and
press <code>F9</code>. This will change numbering of the table and
figure, this change will also be applied to the references you made in
the narratives.</p>
</div>

<script type="text/javascript">
window.onload = function() {
  var i, fig = 1, caps = document.getElementsByClassName('caption');
  for (i = 0; i < caps.length; i++) {
    var cap = caps[i];
    if (cap.parentElement.className !== 'figure' || cap.nodeName !== 'P')
      continue;
    cap.innerHTML = '<span>Figure ' + fig + ':</span> ' + cap.innerHTML;
    fig++;
  }
  fig = 1;
  caps = document.getElementsByTagName('caption');
  for (i = 0; i < caps.length; i++) {
    var cap = caps[i];
    if (cap.parentElement.nodeName !== 'TABLE') continue;
    cap.innerHTML = '<span>Table ' + fig + ':</span> ' + cap.innerHTML;
    fig++;
  }
}
</script>


<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
